# ACSE-4-armageddon

Asteroids entering Earth’s atmosphere are subject to extreme drag forces that decelerate, heat and disrupt the space rocks. The fate of an asteroid is a complex function of its initial mass, speed, trajectory angle and internal strength. 

[Asteroids](https://en.wikipedia.org/wiki/Asteroid) 10-100 m in diameter can penetrate deep into Earth’s atmosphere and disrupt catastrophically, generating an atmospheric disturbance ([airburst](https://en.wikipedia.org/wiki/Air_burst)) that can cause [damage on the ground](https://www.youtube.com/watch?v=tq02C_3FvFo). Such an event occurred over the city of [Chelyabinsk](https://en.wikipedia.org/wiki/Chelyabinsk_meteor) in Russia, in 2013, releasing energy equivalent to about 520 [kilotons of TNT](https://en.wikipedia.org/wiki/TNT_equivalent) (1 kt TNT is equivalent to 4.184e12 J), and injuring thousands of people ([Popova et al., 2013](http://doi.org/10.1126/science.1242642); [Brown et al., 2013](http://doi.org/10.1038/nature12741)). An even larger event occurred over [Tunguska](https://en.wikipedia.org/wiki/Tunguska_event), an unpopulated area in Siberia, in 1908. 

This tool predicts the fate of asteroids entering Earth’s atmosphere for the purposes of hazard assessment.

### Installation Guide

```
python setup.py install --user
```

### User instructions

To determine the outcome of asteroid, in the case where Earth's atmosphere is exponential:
```
import armageddon

earth = armageddon.Planet()

result, outcome = earth.impact(radius=10, angle=45, strength=1e5, velocity=21e3, density=3000)
```
where the input parameters (the intitial conditions) can be changed for different scenarios.

Running `results` returns a dataframe of the results, and `outcome` returns information on whether it is an airburst and/or crater event, and corresponding energy and/or impact time/mass/speed data.

To plot the result
```
armageddon.plot_element_6(result)
```
An alternative method:
```
result = earth.solve_atmospheric_entry(
    radius=10, angle=45, strength=1e5, velocity=21e3, density=3000)
result = earth.calculate_energy(result)
outcome = earth.analyse_outcome(result)
```

To change the the type of atmosphere:
```
earth = armageddon.Planet(atmos_func='tabular',atmos_filename='data/AltitudeDensityTable.csv')
```
then proceed as above. Other atmospheres include 'constant' and 'mars', if using mars, parameters such as gravity, planet radius etc. will need to be changed accordingly. 



Ensemble performs simulations with **probability distributions** as inputs and returns the **distrubution of burst altitude**.

```
import armageddon
import numpy as np

slv_ens = armageddon.solve_ensemble(
    planet = armageddon.Planet(),
    fiducial_impact = {'radius': 10, 'angle': 45, 'strength': 1e5, 'velocity': 21000, 'density': 30000},
    variables = ['radius', 'angle', 'strength', 'velocity', 'density'])
```
Run `slv_ens` to view the results in a dataframe.

To plot the input distribution:
```
armageddon.plot_inputs5({'radius': 10, 'angle': 45,
            'strength': 1e5, 'velocity': 21000, 'density': 30000})
```
To plot the distribution of results:
```
import armageddon

armageddon.plot_output(slv_ens.burst_altitude)
```
It is possible to return results for just one variable, e.g. velocity, changing th `variables` in `slv_ens`. 

To compute the errors in the numerical solution:
```
import armageddon

planet = armageddon.Planet()

errors = armageddon.compute_errors(planet)
```
and run `errors` to display them in a dataframe.

To find the errors without fragmentation add:
```
errors_without_fragmentation = armageddon.compute_errors(planet, fragmentation=False)
```

To compare the errors for different dt with different initial conditions
```
comparison = armageddon.dt_comparison(planet)
```
Run `comparison` to display the results in a dataframe. These errors are computed by comparing the numerical solution with a scipy solution.


Determine impact parameters for Chelyabinsk airburst:
```
import armageddon
import numpy as np

earth = armageddon.Planet()
f_event,height,= armageddon.f_fit_event("data/ChelyabinskEnergyAltitude.csv")
radiu,stre,error = armageddon.get_best_fit(earth, f_event, height, \
                np.linspace(8.1,8.5,10), np.linspace(4.8*10**6, 5.5*10**6, 10))
print('radiu:', radiu, '\nstrength:', stre, '\nMSR: ', error)
```

To plot these results:
```
armageddon.plot_pre3(earth, f_event, height, radiu, stre)
```
### Documentation

The code includes [Sphinx](https://www.sphinx-doc.org) documentation. On systems with Sphinx installed, this can be built by running

```
python -m sphinx docs html
```

then viewing the `index.html` file in the `html` directory in your browser.

For systems with [LaTeX](https://www.latex-project.org/get/) installed, a manual pdf can be generated by running

```
python -m sphinx  -b latex docs latex
```

Then following the instructions to process the `Armageddon.tex` file in the `latex` directory in your browser.

### Testing

The tool includes several tests, which you can use to checki its operation on your system. With [pytest](https://doc.pytest.org/en/latest) installed, these can be run with

```
python -m pytest armageddon
```
